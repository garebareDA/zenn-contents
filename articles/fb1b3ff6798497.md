---
title: "Rustで自作言語のインタプリタを作った話"
emoji: "🦀"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["rust"]
published: false
publication_name: "smartcamp"
---


# リポジトリ
https://github.com/garebareDA/koto

# 前提
字句解析、構文解析を理解または記事を読んでいることを前提として話します。
そしてインタプリタに関してはウェブの情報を下に作成した独自のものなのでおそらく本来イメージするものではないと思われます。
## 字句解析器
https://zenn.dev/smartcamp/articles/a498830e010e18

## 構文解析器
https://zenn.dev/smartcamp/articles/076b673e2782d6

# インタプリタとは
随時解釈しながら実行するプログラムのことです。直接解釈実行するタイプ、中言語を介するタイプなどがあります。
今回の作成したインタプリタの場合は構文木を直接実行しています。Rustの配列を仮想のメモリとして扱っているので仮想マシンに近い実装なのかなぁと勝手思っています。
そして構文分析器とかなり密結合な設計となっています。

# インタプリタで実装したこと
- ミュータブル、イミュータブルな変数
- 関数
- 四則演算
- for
- if
- 配列
- 標準出力
- 変数

## ミュータブル、イミュータブルな変数
変数がミュータブルかイミュータブルかは構文解析時にノードに`Bool`で設定されています。

## 関数
関数には関数自体を定義をしているノード`Call`と関数を実行しているノード`Function`があります。

## for
Rustのfo分を使いループの処理を行っています。
## if
Rustのif文を使い条件分岐を行っています。
## 配列
構文解析時にすでに配列を作っておきます。
## 変数
Rustの配列を仮想メモリにして変数の参照などを行っています。
## 標準出力
Rustの`println!`にそのまま渡しています。