---
title: "Railsã®Auto Loadã®Name Error"
emoji: "ğŸ™"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["ruby", "rails"]
published: true
publication_name: "smartcamp"
---

# Railsã®Auto Loadã¨ã¯

é€šå¸¸ã®Rubyã§ã‚ã‚Œã°ä»–ã®ã‚¯ãƒ©ã‚¹ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ã„ãŸã„å ´åˆæ˜ç¤ºã£ã¦æ°—ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```ruby
require "application_controller"
require "post"

class PostsController < ApplicationController
  def index
    @posts = Post.all
  end
end
```

Railsã¯æ˜ç¤ºçš„ã«`require`ã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆã›ãšã¨ã‚‚ã©ã“ã§ã‚‚åˆ©ç”¨ã§ãã¾ã™ã€‚

```ruby
class PostsController < ApplicationController
  def index
    @posts = Post.all
  end
end
```

Railsã¯Zeitwerkã¨ã„ã†ã‚‚ã®ã‚’ä½¿ã„è‡ªå‹•èª­ã¿è¾¼ã¿ã€å†èª­ã¿è¾¼ã¿ã€eager loadingã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚
ä»Šå›ã¯è‡ªå‹•èª­ã¿è¾¼ã¿ã®ã¿ã®è¨˜äº‹ã§ã™ã€‚

https://github.com/fxn/zeitwerk

# Auto Loadã§èª­ã¿è¾¼ã¾ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã«`app`ä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª(assets, javascript, views ä»¥å¤–)ã«ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒä¾å­˜ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‚¨ãƒ³ã‚¸ãƒ³ã®è‡ªå‹•èª­ã¿è¾¼ã¿ãƒ‘ã‚¹ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯`lib`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãªã©ã¯èª­ã¿è¾¼ã¿ã¾ã›ã‚“ã€‚
èª­ã¿è¾¼ã¿ãƒ‘ã‚¹ã‚’è¿½åŠ ã™ã‚‹ã«ã¯`config/application.rb`ã§`config.autoload_paths`ã«è¿½åŠ ã—ã¾ã™ã€‚

```ruby
module MyApplication
  class Application < Rails::Application
    config.autoload_paths << "#{root}/extras"
  end
end
```

# Libã®Auto Load
`/lib`ã®ã‚ªãƒ¼ãƒˆãƒ­ãƒ¼ãƒ‰ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«å«ã¾ã‚Œã¦ã„ãªã„ã®ã§æ˜ç¤ºçš„ã«è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ã—ã‹ã—ã‚ªãƒ¼ãƒˆãƒ­ãƒ¼ãƒ‰ã‚’ã—ãŸããªã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒé…ä¸‹ã«ã‚ã‚‹å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚
ä¸‹è¨˜ã®ã‚ˆã†ãªè¨­å®šè¡Œã†ã“ã¨ã§Auto Loadã‹ã‚‰é™¤å¤–ã§ãã¾ã™ã€‚
```ruby
config.autoload_lib(ignore: %w(assets tasks))
```

# Auto Loadã®Name Error
Railsã‚’å®Ÿè¡Œã™ã‚‹ã¨ãã«Auto Loadã§è¨­å®šã•ã‚Œã¦ã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã™ã¹ã¦èª­ã¿è¾¼ã¾ã‚Œã‚‹ã®ã§ã€èª¤ã£ã¦é–‹ç™ºç’°å¢ƒã®ã¿ã§ä½¿ã†ã‚ˆã†ãªã‚«ã‚¹ã‚¿ãƒ copãªã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¦ã—ã¾ã†ã¨`NameError: uninitialized constant`ã®ã‚ˆã†ãªæœªå®šç¾©ã®ã‚¨ãƒ©ãƒ¼ãŒã§ã¾ã™ã€‚
`lib`ã‚„ä»–ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒAutoLoadã§è¨­å®šã‚’èªçŸ¥ã—ã¦ã„ãªã„å ´åˆãŒã‚ã‚‹ã®ã§ãƒãƒã‚Šãã†ãªæ‰€ã§ã™ã€‚